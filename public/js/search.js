!function(e){var r,a,n,s=e("body"),t="",i=!1,l=(e(".search-trigger").on("submit",function(r){var a=e(this).find("input");return a.removeClass("error"),t=a.val(),""===t?(a.addClass("error"),!1):(u(t),!1)}),e("#smSearch")),o=l.find("input"),d=(l.find("form"),e("#searchResults"));l.panel({delay:500,hideOnClick:!0,hideOnSwipe:!0,resetScroll:!0,resetForms:!0,side:"right",target:s,visibleClass:"is-search-visible"});var u=function(s){return i&&(r.abort(),r=null,i=!1),i=!0,f(s),a?(i=!1,void c(s)):void(r=e.ajax("/assets/lunr/all.json",{dataType:"json"}).done(function(e,r,t){a=lunr.Index.load(e.index),n=e.store,c(s)}).error(function(e,r,a){h("服务器错误："+a.message||a)}).always(function(e,r,a){i=!1}))},c=function(e){var r=a.search(e);if(l.removeClass("no-res"),0===r.length)return l.addClass("no-res"),void h("无相关结果!");for(var s,t={items:[]},i=r.length,o=0;o<i;o++)s=n[r[o].ref],s.url=s.url.replace(App.root,"/"),t.items.push(s);xhogan.render({target:"#searchResults",tpl:"#tplSearch",data:t,extraTplData:null,tplVersion:"2",dataVersion:"2",appendToTarget:!1,cbk:function(e,r,a,n){}})},f=function(e){s.addClass("is-search-visible"),o.val(e)},h=function(e){d.html(e)}}(jQuery);